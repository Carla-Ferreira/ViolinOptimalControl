import numpy as np


class Bow:
    """
    Contains references from useful markers.
    """

    segment_idx = 8
    contact_marker = 19
    frog_marker = 16
    tip_marker = 18

    def __init__(self, bow_side):
        """
        Contains the side of the bow.
        """
        if bow_side not in ["frog", "tip"]:
            raise RuntimeError(bow_side + " is not a valid side of bow, it must be frog or tip.")
        self.bow_side = bow_side

    @property
    def side(self):
        return self.bow_side


class Violin:
    """
    Contains initial values and references from useful markers and segments.
    """

    segment_idx = 17

    def __init__(self, string):
        """
        Contains some references and values specific to the string.
        :param string: violin string letter
        :param bow_side: side of the bow, "frog" or "tip".
        """
        if string not in ["E", "A", "D", "G"]:
            raise RuntimeError(string + " is not a valid string, it must be E, A, D or G. Do you know violin ?")
        self.string = string

    def initial_position(self):
        """
        :return: List of initial positions according to the string and the side of the bow.
        """
        return {
            "E": {
                "frog": [-0.2908, -0.4622, 0.6952, 1.1347, 1.4096, -0.1030, 0.1516, -0.2379, -0.2633, 0],
                "tip": [0.0876, -0.5649, 0.6498, 1.0598, -0.1866, 0.2434, 0.1582, 0.2087, 0.7162, 0],
            },
            "A": {
                "frog": [-0.1569, -0.5216, 0.5900, 1.1063, 1.4728, 0.0393, 0.3143, -0.3959, -0.4446, 0],
                "tip": [0.0305, -0.6904, 0.3695, 0.8809, 0.1557, 0.2997, 0.2071, 0.1471, 0.5546, 0],
            },
            "D": {
                "frog": [-0.1259, -0.4520, 0.5822, 1.1106, 1.4595, 0.1194, 0.5033, -0.4040, -0.4567, 0],
                "tip": [0.0378, -0.7034, 0.2345, 0.947, 0.1111, 0.4134, 0.2470, 0.2606, 0.4842, 0],
            },
            "G": {
                "frog": [-0.2697, -0.3733, 0.5529, 1.1676, 1.5453, 0.0877, 0.6603, -0.5842, -0.6424, 0],
                "tip": [-0.0182, -1.3112, 0.1928, 0.6092, 0.7065, -0.0755, 0.1720, 0.1136, 0.2626, 0],
            },
        }[self.string]

    @property
    def bridge_marker(self):
        """
        :return: Marker number on the bridge, associate to the string.
        """
        return {"E": 35, "A": 37, "D": 39, "G": 41,}[self.string]

    @property
    def neck_marker(self):
        """
        :return: Marker number on the neck of the violin, associate to the string.
        """
        return {"E": 36, "A": 38, "D": 40, "G": 42, }[self.string]

    @property
    def rt_on_string(self):
        """
        :return: RT number according to the string.
        """
        return {"E": 3, "A": 2, "D": 1, "G": 0, }[self.string]

    @property
    def external_force(self):
        return {"E": np.array([0., 0., 0., 0.40989355, 1.84413989, 0.65660896]),
                "A": np.array([0., 0., 0., 0.30881124, 1.65124622, 1.08536701]),
                "D": np.array([0., 0., 0., 0.16081784, 1.30189937, 1.50970052]),
                "G": np.array([0., 0., 0., 0.05865013, 1.05013794, 1.7011086])}[self.string]

    @property
    def x_init(self):
        return {"G": np.array([[-7.57346764e-02, -3.28372718e-01, -3.90231559e-01,
        -3.91907279e-01, -3.90754479e-01, -3.83859237e-01,
        -3.62153053e-01, -3.29033040e-01, -3.01225285e-01,
        -2.74803499e-01, -2.37681110e-01, -1.86230500e-01,
        -1.26088742e-01, -7.26219972e-02, -3.90175022e-02,
        -2.52317279e-02, -2.32807592e-02, -2.14283229e-02,
        -1.58260621e-02, -1.40814846e-02, -1.77636058e-02,
        -2.48374823e-02, -3.62383840e-02, -5.77652402e-02,
        -9.21923556e-02, -1.24568599e-01, -1.66594967e-01,
        -2.23770611e-01, -2.75525228e-01, -2.84287982e-01,
        -2.20804347e-01],
       [-1.32351864e+00, -1.09376736e+00, -1.04966163e+00,
        -1.05928149e+00, -1.06247518e+00, -1.06267823e+00,
        -1.07279008e+00, -1.09470203e+00, -1.11360776e+00,
        -1.13717147e+00, -1.18328288e+00, -1.25872019e+00,
        -1.35017168e+00, -1.41838486e+00, -1.41756744e+00,
        -1.33205151e+00, -1.19610619e+00, -1.06927743e+00,
        -9.74315143e-01, -8.96874245e-01, -8.35478818e-01,
        -7.96592834e-01, -7.78538003e-01, -7.72910460e-01,
        -7.73187257e-01, -7.95501913e-01, -8.23236341e-01,
        -8.46071761e-01, -8.78332297e-01, -9.47500563e-01,
        -1.07916690e+00],
       [-1.86021000e-02,  4.60155967e-02,  6.96446409e-02,
         8.38824632e-02,  1.01817526e-01,  1.18307164e-01,
         1.30151186e-01,  1.38480551e-01,  1.45548261e-01,
         1.51103722e-01,  1.55473650e-01,  1.60271854e-01,
         1.66523320e-01,  1.72512802e-01,  1.73822621e-01,
         1.66946903e-01,  1.53327234e-01,  1.39061884e-01,
         1.27319133e-01,  1.17788281e-01,  1.12145057e-01,
         1.13655951e-01,  1.23732346e-01,  1.42019377e-01,
         1.65297955e-01,  1.86169909e-01,  2.00417028e-01,
         2.04453061e-01,  1.91559299e-01,  1.53950277e-01,
         9.05883668e-02],
       [ 1.25179621e+00,  1.24599381e+00,  1.19558731e+00,
         1.13851833e+00,  1.09441381e+00,  1.06744412e+00,
         1.05529895e+00,  1.05795411e+00,  1.07831310e+00,
         1.11227225e+00,  1.15137316e+00,  1.18942576e+00,
         1.22215871e+00,  1.24688148e+00,  1.25835868e+00,
         1.24886759e+00,  1.21758520e+00,  1.17012792e+00,
         1.11538383e+00,  1.06268214e+00,  1.01717456e+00,
         9.80952052e-01,  9.56054180e-01,  9.46363436e-01,
         9.56572911e-01,  9.86986210e-01,  1.04044220e+00,
         1.11227714e+00,  1.18896001e+00,  1.25364473e+00,
         1.29277767e+00],
       [ 1.41993664e+00,  1.42071608e+00,  1.38331255e+00,
         1.30841528e+00,  1.20237974e+00,  1.07832226e+00,
         9.45945303e-01,  8.03343776e-01,  6.49679861e-01,
         4.93395285e-01,  3.48713602e-01,  2.23413461e-01,
         1.20794350e-01,  4.11146620e-02, -1.27012664e-02,
        -2.87589276e-02,  4.57847272e-03,  8.76999176e-02,
         1.99596094e-01,  3.16501289e-01,  4.31579989e-01,
         5.50910074e-01,  6.79016414e-01,  8.17212747e-01,
         9.55920886e-01,  1.09029046e+00,  1.21010462e+00,
         1.30567550e+00,  1.37336184e+00,  1.40857209e+00,
         1.39980484e+00],
       [-3.25669609e-01, -2.07199328e-01, -1.76592738e-01,
        -1.68066864e-01, -1.54478620e-01, -1.38213155e-01,
        -1.23841824e-01, -1.12056429e-01, -9.92900286e-02,
        -9.08774438e-02, -9.60232948e-02, -1.18889092e-01,
        -1.51368158e-01, -1.68251586e-01, -1.36729045e-01,
        -4.27581717e-02,  8.55566354e-02,  1.98183083e-01,
         2.76316710e-01,  3.29838745e-01,  3.59512820e-01,
         3.58503526e-01,  3.26434953e-01,  2.68764518e-01,
         1.98089998e-01,  1.17057859e-01,  4.22308368e-02,
        -1.51843314e-02, -6.15337589e-02, -1.13808062e-01,
        -1.88129861e-01],
       [-6.24775556e-02, -4.59662412e-02, -3.87378702e-02,
        -2.85721463e-02, -1.11553323e-02,  9.78096277e-03,
         3.13661230e-02,  5.11473331e-02,  6.70427598e-02,
         7.78632372e-02,  8.42122678e-02,  8.82749610e-02,
         9.38623130e-02,  1.04627555e-01,  1.22834514e-01,
         1.49250518e-01,  1.84015833e-01,  2.27226000e-01,
         2.76854981e-01,  3.28469799e-01,  3.76695020e-01,
         4.16746432e-01,  4.44840234e-01,  4.56566616e-01,
         4.48081319e-01,  4.17031163e-01,  3.64039904e-01,
         2.94803703e-01,  2.16502353e-01,  1.34755729e-01,
         5.28142149e-02],
       [ 1.60685151e-01,  4.73890019e-03, -5.49559843e-03,
         6.89212115e-02,  1.69654465e-01,  2.38957338e-01,
         2.59928477e-01,  2.61367963e-01,  2.59613292e-01,
         2.47018990e-01,  2.10014372e-01,  1.56584325e-01,
         1.03702458e-01,  6.36178793e-02,  3.82094983e-02,
         1.61962097e-02, -1.13667508e-02, -4.18969627e-02,
        -4.45971395e-02,  9.32703188e-03,  1.06257493e-01,
         2.00637778e-01,  2.58824464e-01,  2.61368212e-01,
         2.22442661e-01,  1.46195883e-01,  4.74719955e-02,
        -4.09562088e-02, -8.58827667e-02, -4.56574314e-02,
         1.45279393e-01],
       [-7.85056925e-01, -5.58489278e-01, -4.40717641e-01,
        -3.81502642e-01, -3.33075867e-01, -2.55561880e-01,
        -1.41292555e-01, -1.49619397e-02,  1.10352723e-01,
         2.37441323e-01,  3.71721741e-01,  5.03564462e-01,
         6.17621553e-01,  7.03058841e-01,  7.55893511e-01,
         7.81357501e-01,  7.84834712e-01,  7.65094057e-01,
         7.03613316e-01,  5.84964039e-01,  4.21580415e-01,
         2.45768130e-01,  8.14368947e-02, -5.58358052e-02,
        -1.70496415e-01, -2.61173508e-01, -3.25968875e-01,
        -3.79494401e-01, -4.47022653e-01, -5.65320364e-01,
        -7.85196869e-01],
       [-7.00000000e-02, -9.56112533e-02, -1.29932422e-01,
        -1.70883663e-01, -2.16619248e-01, -2.64754980e-01,
        -3.13171331e-01, -3.60416423e-01, -4.04615689e-01,
        -4.44165006e-01, -4.77831975e-01, -5.05109236e-01,
        -5.25886885e-01, -5.40242757e-01, -5.48247614e-01,
        -5.50000000e-01, -5.45551874e-01, -5.34828171e-01,
        -5.18302558e-01, -4.96590523e-01, -4.69723154e-01,
        -4.37289315e-01, -3.99340985e-01, -3.56062503e-01,
        -3.08949363e-01, -2.59991607e-01, -2.11571220e-01,
        -1.66355695e-01, -1.26510268e-01, -9.37424708e-02,
        -7.00000000e-02],
       [-2.90596739e+01, -6.22469276e+00, -2.10545567e+00,
         1.04088396e+00, -5.48105083e-01,  9.85176560e-01,
         1.51363572e+00,  2.26957160e+00,  1.29594852e+00,
         1.75973986e+00,  2.45122949e+00,  3.35158814e+00,
         3.57711750e+00,  2.78109466e+00,  1.49416717e+00,
         4.95399507e-01, -3.61364334e-02,  1.44285260e-01,
         3.43004597e-01, -1.19639559e-01, -2.98604068e-01,
        -4.73089059e-01, -7.02392063e-01, -1.54631868e+00,
        -2.20868946e+00, -1.65564503e+00, -3.02931685e+00,
        -3.62844602e+00, -2.71986570e+00,  9.56292058e-01,
         5.48010362e+00],
       [ 2.89276809e+01,  4.55842363e+00,  1.77454758e+00,
        -1.86177857e+00,  1.09441779e+00, -6.21073264e-01,
        -4.52168979e-01, -1.90056252e+00, -6.88270146e-01,
        -1.97545491e+00, -3.17693133e+00, -5.23801164e+00,
        -5.27236151e+00, -2.98364041e+00,  2.21753019e+00,
         6.94180885e+00,  8.71422463e+00,  6.91095864e+00,
         5.03987290e+00,  4.36166254e+00,  3.06763470e+00,
         1.52153731e+00,  3.46771958e-01, -1.34448537e-01,
        -4.38541917e-01, -2.16386045e+00, -1.52782823e+00,
        -1.42545111e+00, -2.25900189e+00, -5.23849314e+00,
        -9.34759702e+00],
       [ 6.41294457e+00,  1.90354941e+00,  1.11960380e+00,
         8.19227495e-01,  1.19623714e+00,  8.60012853e-01,
         5.69616659e-01,  4.57024041e-01,  3.67476292e-01,
         3.06424789e-01,  2.22977333e-01,  3.43949371e-01,
         4.01881539e-01,  3.42505079e-01, -9.54683218e-02,
        -6.42037354e-01, -9.60902044e-01, -8.11063368e-01,
        -6.56453522e-01, -5.02730935e-01, -1.80569270e-01,
         3.55327131e-01,  8.36882289e-01,  1.30288055e+00,
         1.41706301e+00,  1.00340970e+00,  5.93910028e-01,
        -1.72940776e-01, -1.33031283e+00, -2.93646612e+00,
        -4.22518129e+00],
       [ 3.52915728e+00, -2.51096896e+00, -3.34265359e+00,
        -3.32759514e+00, -2.03918775e+00, -1.14784029e+00,
        -3.34482942e-01,  6.41400542e-01,  1.71654059e+00,
         2.31967345e+00,  2.39895790e+00,  2.22590939e+00,
         1.76306139e+00,  1.25004677e+00,  1.56061077e-01,
        -1.27127944e+00, -2.47005371e+00, -3.21660126e+00,
        -3.34171016e+00, -2.99556018e+00, -2.46716786e+00,
        -1.83561191e+00, -1.13232689e+00, -4.46415554e-02,
         1.22823431e+00,  2.39467562e+00,  3.86788014e+00,
         4.65606129e+00,  4.51787865e+00,  3.31256108e+00,
         1.54717773e+00],
       [ 1.40689907e-01, -1.05028457e+00, -3.49121864e+00,
        -5.48379489e+00, -7.01665450e+00, -7.74489083e+00,
        -7.96247665e+00, -8.94801301e+00, -9.33147215e+00,
        -9.21206517e+00, -8.19808629e+00, -6.93818380e+00,
        -5.47899744e+00, -4.13647842e+00, -2.27186713e+00,
         4.46013402e-01,  3.55091934e+00,  6.24538161e+00,
         7.06100372e+00,  6.94869513e+00,  6.85157903e+00,
         7.32027485e+00,  8.01718703e+00,  8.53245477e+00,
         8.10297512e+00,  7.88615627e+00,  6.54895186e+00,
         4.92073795e+00,  3.11683558e+00,  9.14218325e-01,
        -2.11493163e+00],
       [ 1.36865510e+01,  2.89718463e+00,  1.20777027e+00,
         1.89770266e-01,  1.32345677e+00,  8.02669762e-01,
         1.00230914e+00,  4.86812657e-01,  9.11272583e-01,
         1.27848520e-01, -5.74619314e-01, -1.86507213e+00,
        -1.80499258e+00, -3.19301853e-01,  3.48915507e+00,
         6.99736284e+00,  7.92983986e+00,  5.87365691e+00,
         3.89587626e+00,  2.64724482e+00,  9.90715964e-01,
        -1.08432143e+00, -2.87696329e+00, -4.16111656e+00,
        -4.47721243e+00, -5.07444520e+00, -4.01785765e+00,
        -2.97528418e+00, -2.55905368e+00, -3.44297833e+00,
        -5.03599822e+00],
       [ 2.96783544e+00,  3.25376417e-02,  1.07414692e+00,
         4.33254847e-01,  1.52966319e+00,  1.09166349e+00,
         1.50318676e+00,  9.36560404e-01,  9.10520615e-01,
         4.34734083e-01,  3.91441903e-01,  1.97492946e-01,
         4.59614568e-01,  7.11873117e-01,  1.26385414e+00,
         1.82145813e+00,  2.43235407e+00,  2.87563508e+00,
         3.12713385e+00,  3.08148651e+00,  2.70568076e+00,
         2.02735223e+00,  1.25468820e+00,  6.32848644e-02,
        -1.16940170e+00, -2.54246968e+00, -3.75789018e+00,
        -4.53668287e+00, -4.80776799e+00, -4.81015580e+00,
        -4.64888901e+00],
       [-1.59097913e+01, -3.74311922e+00,  2.46957866e+00,
         6.18621375e+00,  5.16659125e+00,  2.64062617e+00,
        -6.70918663e-01,  1.52968804e-01, -7.13210590e-01,
        -1.35510910e+00, -2.95458379e+00, -3.24499876e+00,
        -2.87454070e+00, -1.77056747e+00, -1.17159398e+00,
        -1.42195980e+00, -1.70776844e+00, -1.51969791e+00,
         1.46889647e+00,  4.99465122e+00,  6.55821457e+00,
         4.97901214e+00,  1.98995758e+00, -1.54295752e+00,
        -2.93845002e+00, -5.62443872e+00, -6.03405881e+00,
        -4.37708581e+00, -7.05858974e-01,  6.06885620e+00,
         1.72609658e+01],
       [ 1.84038834e+01,  9.29193388e+00,  4.93946183e+00,
         2.44289026e+00,  3.86481037e+00,  5.85691169e+00,
         8.27531239e+00,  7.42094768e+00,  7.84418784e+00,
         7.81202240e+00,  8.23534551e+00,  7.47088051e+00,
         6.07176697e+00,  4.06275652e+00,  2.19234901e+00,
         8.15863973e-01, -5.27226289e-01, -2.12542952e+00,
        -5.41655958e+00, -8.80934263e+00, -1.07469285e+01,
        -1.05117674e+01, -9.25145676e+00, -7.38882906e+00,
        -6.58100895e+00, -4.66554493e+00, -3.30324334e+00,
        -3.30960854e+00, -4.98956710e+00, -9.43460144e+00,
        -1.70437966e+01],
       [-1.19019579e+00, -1.84173805e+00, -2.27284713e+00,
        -2.63478586e+00, -2.83372753e+00, -2.92365451e+00,
        -2.86621873e+00, -2.77884613e+00, -2.51348050e+00,
        -2.21130273e+00, -1.82713824e+00, -1.44510066e+00,
        -1.05318118e+00, -6.83112413e-01, -3.00167609e-01,
         7.48231562e-02,  4.56854684e-01,  8.36160843e-01,
         1.15197699e+00,  1.45667155e+00,  1.76783618e+00,
         2.10810983e+00,  2.43851715e+00,  2.74641474e+00,
         2.89787170e+00,  2.95602050e+00,  2.84081115e+00,
         2.57814038e+00,  2.20007797e+00,  1.72562608e+00,
         1.09175694e+00]])}[self.string]

    @property
    def u_init(self):
        return {"G": np.array([[ 3.74466159e-04, -3.75970162e-04, -1.74688220e-04,
        -7.48719490e-04, -3.82301746e-04, -1.17076202e-04,
        -2.62059533e-04, -6.20161990e-04, -4.85134780e-04,
        -1.55335917e-04,  2.87387580e-04,  1.08759729e-03,
         1.46485029e-03,  1.66774124e-03,  1.51035295e-03,
         1.06047089e-03,  1.09411723e-03,  1.34899841e-03,
         9.81091968e-04,  8.20089317e-04,  5.15497230e-04,
         2.41454230e-04, -6.72047033e-04, -1.07857852e-03,
        -9.49659591e-04, -1.85515002e-03, -1.97061933e-03,
        -1.36204614e-03,  3.39740122e-05,  2.25743562e-03],
       [ 1.13390785e-02,  7.43040230e-03, -3.46976782e-03,
        -3.28785594e-03, -5.50151295e-03, -4.57372420e-03,
        -6.18062472e-03, -4.96377602e-03, -5.15374793e-03,
        -4.07842060e-03, -4.28932010e-03, -2.38172272e-03,
        -9.79399006e-05,  2.96525520e-03,  5.12637991e-03,
         6.86650604e-03,  5.70030740e-03,  2.60390744e-03,
        -8.18664806e-04, -2.49288622e-03, -3.61987825e-03,
        -3.41828757e-03, -3.27033301e-03, -2.15194196e-03,
        -1.31695423e-03,  5.78152730e-03,  6.15035970e-03,
         4.36050724e-03, -1.05147946e-03, -5.82564051e-04],
       [-2.63698740e-03, -6.34063237e-04,  1.48344837e-03,
         9.18740280e-04,  5.92152853e-04, -1.43787207e-04,
         2.90678362e-04, -6.08522651e-06,  3.03992335e-04,
         1.16859283e-04,  1.48382661e-04, -5.37155625e-04,
        -1.32619217e-03, -1.42745384e-03, -2.57265651e-03,
        -2.25505533e-03, -2.49579479e-03, -5.00496173e-04,
         1.39108609e-03,  2.77418253e-03,  2.81690857e-03,
         2.58377161e-03,  2.88772040e-03,  2.61885755e-03,
         1.94755091e-03, -2.16522646e-03, -2.19002980e-03,
        -1.61970210e-03, -1.38047090e-04, -6.71995277e-04],
       [-2.48096579e-03, -1.68696921e-03,  2.69322140e-03,
         6.60543604e-03,  8.63072282e-03,  8.15502445e-03,
         1.03036377e-02,  1.16487274e-02,  1.13612859e-02,
         9.69823888e-03,  7.61764341e-03,  4.00809526e-03,
         5.94031961e-04, -1.91030008e-03, -3.14747571e-03,
        -1.89628029e-03,  4.52657940e-04,  3.67543918e-03,
         7.06540358e-03,  8.14802480e-03,  8.33132595e-03,
         6.69402582e-03,  6.97900701e-03,  6.25146458e-03,
         7.14529340e-03,  1.07725773e-02,  9.87593598e-03,
         6.87736528e-03,  2.00961184e-03, -2.97101042e-03],
       [ 2.44685104e-02,  5.64882624e-02,  6.98807557e-02,
         7.58623760e-02,  7.19472409e-02,  6.49902207e-02,
         4.90289637e-02,  3.74310798e-02,  3.26651212e-02,
         2.94826688e-02,  2.63152046e-02,  2.45476640e-02,
         2.26706627e-02,  2.39406047e-02,  2.62901055e-02,
         2.97049180e-02,  3.25262523e-02,  2.94310507e-02,
         2.77670159e-02,  2.99539647e-02,  3.45464503e-02,
         4.40240821e-02,  5.09363520e-02,  6.71307107e-02,
         8.14686411e-02,  8.64009885e-02,  8.73806668e-02,
         7.87506711e-02,  6.34779169e-02,  3.49834420e-02],
       [ 9.25546447e-03,  1.94047719e-01,  3.56663962e-01,
         4.35196148e-01,  5.02403240e-01,  4.68784959e-01,
         3.79706804e-01,  2.98676207e-01,  2.57312247e-01,
         2.23282394e-01,  1.72866564e-01,  1.58969566e-01,
         1.25761109e-01,  1.40553813e-01,  1.27646955e-01,
         1.56441007e-01,  1.48029732e-01,  1.05429017e-01,
         6.74864087e-02,  9.36194809e-02,  1.46610892e-01,
         2.44671168e-01,  3.24378599e-01,  4.31014653e-01,
         5.40676339e-01,  5.25295604e-01,  4.73794889e-01,
         3.62194789e-01,  2.49515521e-01,  4.18174319e-02],
       [-2.49218822e-01, -2.28030741e-01, -2.20176742e-01,
        -1.87280161e-01, -1.65824853e-01, -1.34677376e-01,
        -1.18069065e-01, -9.29483077e-02, -7.51090371e-02,
        -5.99526681e-02, -4.62819882e-02, -4.33305281e-02,
        -3.13992405e-02, -3.40862872e-02, -2.37678391e-02,
        -3.26118454e-02, -2.97069791e-02, -4.50904606e-02,
        -4.69071615e-02, -6.28215678e-02, -6.58103540e-02,
        -8.26310472e-02, -9.79523577e-02, -1.25175613e-01,
        -1.52920691e-01, -1.86728765e-01, -2.06685988e-01,
        -2.34374013e-01, -2.38520299e-01, -2.57363520e-01],
       [ 9.32600746e-03, -5.66546806e-02, -1.26769790e-01,
        -1.46077596e-01, -8.46937189e-02,  6.55132084e-02,
         2.53821846e-01,  3.81462799e-01,  4.37681221e-01,
         4.77732391e-01,  5.16719068e-01,  5.20801080e-01,
         5.10148189e-01,  4.80063809e-01,  4.32535422e-01,
         4.24025604e-01,  4.43550774e-01,  5.07791340e-01,
         5.18717309e-01,  4.91997918e-01,  4.43671065e-01,
         3.99065154e-01,  3.55179164e-01,  2.42569022e-01,
         8.84222084e-02, -7.23789934e-02, -1.50214033e-01,
        -1.73632433e-01, -1.08370870e-01, -2.21245603e-02],
       [ 3.71948008e-02,  2.54262980e-02,  2.67054608e-02,
         2.65895056e-02,  2.61289099e-02,  2.73559067e-02,
         2.59821782e-02,  2.75722296e-02,  2.60507245e-02,
         2.76760846e-02,  2.59425202e-02,  2.78569070e-02,
         2.58600786e-02,  2.69874742e-02,  2.61928266e-02,
         2.73276474e-02,  2.52424028e-02,  2.83351915e-02,
         2.60416624e-02,  2.79978774e-02,  2.61250292e-02,
         2.78233839e-02,  2.57127041e-02,  2.76741698e-02,
         2.56532314e-02,  2.77115703e-02,  2.54245762e-02,
         2.76689071e-02,  2.49390768e-02,  2.71539602e-02],
       [-5.02636736e-03, -4.95523394e-03, -5.02514039e-03,
        -4.95515844e-03, -5.02490793e-03, -4.95515768e-03,
        -5.02489895e-03, -4.95515537e-03, -5.02488109e-03,
        -4.95516002e-03, -5.02486348e-03, -4.95517088e-03,
        -5.02484590e-03, -4.95499798e-03, -5.02490223e-03,
        -4.95497372e-03, -5.02474927e-03, -4.95519632e-03,
        -5.02491094e-03, -4.95511885e-03, -5.02493361e-03,
        -4.95518666e-03, -5.02485512e-03, -4.95516959e-03,
        -5.02485846e-03, -4.95520162e-03, -5.02482040e-03,
        -4.95524964e-03, -5.02488860e-03, -4.95518026e-03],
       [ 3.67372242e-03,  4.78594503e-03,  4.93474176e-02,
         4.92700412e-02,  7.75383021e-02,  7.46209037e-02,
         9.45203716e-02,  9.47629293e-02,  9.90626663e-02,
         9.21552516e-02,  8.43834324e-02,  6.88309390e-02,
         3.92523974e-02,  2.36598717e-02,  1.10988292e-02,
         1.25841746e-02,  2.09287866e-02,  6.50855768e-02,
         1.01919175e-01,  1.21273427e-01,  1.15729983e-01,
         9.21363005e-02,  8.03039105e-02,  6.28998278e-02,
         6.50002104e-02,  3.91043994e-02,  1.53442655e-02,
         7.93025257e-03,  2.17103284e-02,  6.56681604e-02],
       [ 5.58508832e-03,  6.45046870e-03,  3.56877474e-02,
         2.75002166e-02,  4.40254875e-02,  4.31976784e-02,
         5.16485734e-02,  4.61108208e-02,  4.94826435e-02,
         4.91766867e-02,  4.88062729e-02,  4.82820033e-02,
         3.46178009e-02,  2.98448454e-02,  1.94248349e-02,
         1.81623012e-02,  2.24438693e-02,  4.11425105e-02,
         5.00009890e-02,  5.45262803e-02,  4.77286742e-02,
         3.82771617e-02,  2.47925119e-02,  1.81990829e-02,
         1.91301031e-02,  6.35924139e-03,  4.50753194e-03,
         4.79996609e-03,  1.66808715e-02,  6.82339619e-02],
       [ 1.59398068e-02,  1.84590341e-02,  1.77400076e-02,
         1.76184656e-02,  1.47731460e-02,  1.37865680e-02,
         1.34387539e-02,  1.52898492e-02,  1.71902561e-02,
         1.95643067e-02,  2.01446428e-02,  1.84555783e-02,
         1.56783669e-02,  1.43109520e-02,  1.29060472e-02,
         1.59704202e-02,  1.76486746e-02,  1.98876785e-02,
         1.98932890e-02,  1.72898011e-02,  1.41431202e-02,
         1.32065677e-02,  1.33221259e-02,  1.49576379e-02,
         1.52944392e-02,  1.83741220e-02,  2.10741656e-02,
         2.21590974e-02,  1.60963480e-02,  1.21185590e-02],
       [ 1.63276544e-03,  6.56684413e-04,  4.61644101e-04,
         3.86148626e-04,  3.55002668e-04,  3.53041241e-04,
         4.14041816e-04,  4.99679344e-04,  5.32470500e-04,
         5.68281025e-04,  6.05576669e-04,  6.30013728e-04,
         6.51827112e-04,  6.17606254e-04,  5.47271936e-04,
         5.03600723e-04,  4.50815393e-04,  5.01785448e-04,
         5.40816285e-04,  5.01918920e-04,  4.42764977e-04,
         3.66782917e-04,  3.43647132e-04,  2.89634588e-04,
         2.63039600e-04,  2.76696316e-04,  3.08678432e-04,
         3.74756240e-04,  4.84017245e-04,  8.66712108e-04],
       [ 2.37472063e-03,  1.02421905e-03,  7.63877486e-04,
         6.24584023e-04,  5.67663188e-04,  5.44636869e-04,
         6.26214372e-04,  7.19749216e-04,  7.26350731e-04,
         7.34791069e-04,  7.63215749e-04,  7.86996604e-04,
         8.30176779e-04,  7.78495122e-04,  7.01209399e-04,
         6.08273800e-04,  5.41883294e-04,  5.98928541e-04,
         6.58482478e-04,  6.37367639e-04,  5.96805723e-04,
         5.04984723e-04,  4.91258865e-04,  4.23978641e-04,
         4.08381678e-04,  4.48687437e-04,  5.19744953e-04,
         6.48977547e-04,  8.83880655e-04,  1.64547534e-03],
       [ 2.26214690e-03,  9.78043919e-04,  7.37915974e-04,
         6.12360853e-04,  5.65344105e-04,  5.49304276e-04,
         6.38019611e-04,  7.38209328e-04,  7.46997670e-04,
         7.54130094e-04,  7.77733614e-04,  7.95317115e-04,
         8.29513392e-04,  7.71546663e-04,  6.90730886e-04,
         5.99760575e-04,  5.39469778e-04,  6.02825601e-04,
         6.71709382e-04,  6.54184039e-04,  6.15316315e-04,
         5.20862849e-04,  5.04919984e-04,  4.32703314e-04,
         4.12019643e-04,  4.46603030e-04,  5.09134421e-04,
         6.27418738e-04,  8.45390816e-04,  1.57015745e-03],
       [ 5.33327487e-03,  7.07292968e-03,  4.36535066e-02,
         9.02250018e-02,  1.18125618e-01,  1.10207698e-01,
         1.35754165e-01,  1.48325806e-01,  1.41054958e-01,
         1.17012654e-01,  9.07962634e-02,  5.08192972e-02,
         2.44964931e-02,  1.14496281e-02,  8.71564118e-03,
         1.14085110e-02,  1.88041998e-02,  5.31171681e-02,
         9.51776846e-02,  1.16532784e-01,  1.19899271e-01,
         9.76438464e-02,  1.00507619e-01,  8.79574412e-02,
         9.68987600e-02,  1.36134220e-01,  1.22782805e-01,
         8.34789073e-02,  3.14789085e-02,  6.97749810e-03],
       [ 1.18189213e-02,  5.10503940e-03,  6.37195884e-02,
         1.72806325e-01,  2.46336118e-01,  2.39896776e-01,
         2.87469972e-01,  3.08931005e-01,  2.81333114e-01,
         2.21868801e-01,  1.50681860e-01,  7.47250249e-02,
         5.24982602e-02,  5.11100620e-02,  6.72455309e-02,
         8.13404771e-02,  5.65271826e-02,  1.16528277e-01,
         1.84333230e-01,  2.51994279e-01,  2.76715087e-01,
         2.35259872e-01,  2.38768323e-01,  1.97908674e-01,
         2.19083125e-01,  2.93285834e-01,  2.65279009e-01,
         1.77648425e-01,  6.45098136e-02,  4.39412521e-03],
       [ 8.20428508e-03,  8.67320037e-03,  1.07395099e-02,
         7.45937892e-03,  8.26245014e-03,  9.91447330e-03,
         8.31308543e-03,  6.81754094e-03,  6.90041122e-03,
         8.05865001e-03,  1.16359905e-02,  1.84425463e-02,
         2.32457175e-02,  1.54400849e-02,  1.64127517e-02,
         9.32950568e-03,  1.38034017e-02,  7.89409427e-03,
         5.42057260e-03,  3.89841626e-03,  3.96968256e-03,
         4.47040193e-03,  4.17722913e-03,  4.62272768e-03,
         4.89440620e-03,  6.71336423e-03,  6.99593500e-03,
         8.91712494e-03,  1.46151254e-02,  2.98864391e-02],
       [ 6.61303876e-04,  1.10280458e-03,  1.07196482e-01,
         4.52034118e-02,  7.85015445e-02,  4.32671106e-02,
         6.93100428e-02,  2.18989634e-02,  3.48436397e-02,
         2.62498399e-02,  5.48491384e-02,  3.08199415e-02,
         1.04917475e-02,  3.63754945e-03,  1.84041858e-03,
         1.25212148e-03,  1.13645529e-03,  1.77604683e-03,
         4.23510161e-03,  1.23743158e-02,  3.11987545e-02,
         3.93863767e-02,  3.19609601e-02,  1.27934645e-02,
         4.13216514e-03,  6.48362764e-04,  6.50946874e-04,
         9.44485375e-04,  1.88565954e-02,  5.57420017e-02],
       [ 1.98368046e-03,  2.99752150e-03,  3.12637894e-02,
         1.69183506e-02,  3.08559831e-02,  2.67397762e-02,
         3.30481942e-02,  1.65245648e-02,  1.72323612e-02,
         1.43090939e-02,  2.20173726e-02,  2.11866582e-02,
         1.70135873e-02,  8.22991510e-03,  5.33466718e-03,
         3.12376707e-03,  3.43753355e-03,  4.27796007e-03,
         6.42934344e-03,  8.23449126e-03,  1.29379670e-02,
         1.61794685e-02,  1.44241429e-02,  1.10334808e-02,
         8.14450427e-03,  2.33886726e-03,  2.28027750e-03,
         3.12967813e-03,  1.76953988e-02,  3.53842214e-02],
       [ 2.13319196e-01,  9.59840136e-02,  2.74612436e-03,
         1.54137736e-03,  1.21808833e-03,  1.38039039e-03,
         1.03630614e-03,  9.82487592e-04,  9.56551312e-04,
         1.11716047e-03,  1.27736287e-03,  2.47094986e-03,
         1.80834805e-02,  1.11084130e-01,  1.79627426e-01,
         1.73661974e-01,  7.55955192e-02,  4.59439062e-03,
         1.43362406e-03,  1.67704212e-03,  2.02841034e-03,
         3.58408968e-03,  3.16565524e-03,  2.59602699e-03,
         1.95910155e-03,  9.06644364e-04,  1.00051629e-03,
         1.47325787e-03,  6.44585967e-03,  8.59351474e-02],
       [ 3.25076673e-01,  4.86534253e-01,  4.27356958e-01,
         4.57885020e-01,  3.72667659e-01,  3.64206692e-01,
         2.39629901e-01,  1.70960715e-01,  1.28821573e-01,
         1.17974703e-01,  1.12269110e-01,  1.28983012e-01,
         1.47254615e-01,  1.85487327e-01,  2.18831499e-01,
         2.50003696e-01,  2.69164892e-01,  2.41870766e-01,
         2.31174326e-01,  2.52940326e-01,  3.16215187e-01,
         4.14807124e-01,  4.57934501e-01,  5.39542917e-01,
         5.58453149e-01,  4.92927297e-01,  4.47634098e-01,
         4.38474941e-01,  4.26254064e-01,  3.78599626e-01],
       [ 1.78586036e-01,  3.39505440e-01,  4.15825089e-01,
         5.06891710e-01,  4.81322331e-01,  4.48429972e-01,
         3.79821365e-01,  3.40214686e-01,  3.01448477e-01,
         2.61173249e-01,  2.13354663e-01,  1.56721885e-01,
         1.15536630e-01,  9.01803716e-02,  1.00449370e-01,
         1.28321004e-01,  1.79841554e-01,  2.20921625e-01,
         2.74366903e-01,  3.03099849e-01,  3.32548526e-01,
         3.51232760e-01,  3.83112320e-01,  4.53537481e-01,
         5.20642374e-01,  6.16257712e-01,  5.99631834e-01,
         5.13549265e-01,  3.62155221e-01,  2.06458678e-01],
       [ 1.45510858e-02,  1.82922177e-02,  1.72458193e-02,
         2.04046166e-02,  1.83249980e-02,  1.69829171e-02,
         1.77538841e-02,  1.99987287e-02,  1.91705968e-02,
         1.73139993e-02,  1.47213955e-02,  1.11441691e-02,
         9.58632655e-03,  8.95407126e-03,  9.40662548e-03,
         1.09856688e-02,  1.08558499e-02,  9.93103556e-03,
         1.13003834e-02,  1.19833154e-02,  1.34463642e-02,
         1.49198194e-02,  2.11027884e-02,  2.42743116e-02,
         2.30829076e-02,  3.06038486e-02,  3.11730591e-02,
         2.54046267e-02,  1.61720972e-02,  8.10113361e-03],
       [ 1.92527652e-02,  1.34448648e-02,  1.49411292e-02,
         1.12083073e-02,  1.34302696e-02,  1.54737742e-02,
         1.44119919e-02,  1.24785264e-02,  1.32587436e-02,
         1.55305050e-02,  1.78128582e-02,  2.30195573e-02,
         2.23118656e-02,  2.27483061e-02,  2.06957611e-02,
         1.93196361e-02,  1.93457836e-02,  2.01132763e-02,
         1.88605968e-02,  1.84318078e-02,  1.77589768e-02,
         1.69720753e-02,  1.45322570e-02,  1.29848310e-02,
         1.29393140e-02,  9.69014618e-03,  8.75797950e-03,
         9.63791937e-03,  1.65804945e-02,  3.72838236e-02],
       [ 7.55452262e-03,  4.04652290e-02,  2.54714590e-02,
         7.35191960e-02,  4.16364903e-02,  2.33439203e-02,
         3.40068863e-02,  6.58361403e-02,  5.33054977e-02,
         2.59500886e-02,  7.62757706e-03,  2.51012208e-03,
         2.16451827e-03,  1.96880132e-03,  2.44510961e-03,
         3.39785340e-03,  3.34291330e-03,  2.74339056e-03,
         3.77571054e-03,  4.41630844e-03,  6.33720696e-03,
         1.00604787e-02,  5.32192341e-02,  8.41706936e-02,
         7.81497259e-02,  1.53984746e-01,  1.67609183e-01,
         1.23069965e-01,  1.31298873e-02,  1.16253598e-03],
       [ 3.34455203e-02,  8.75429910e-03,  1.19248548e-02,
         5.64178060e-03,  8.84127208e-03,  1.34352340e-02,
         1.06176737e-02,  6.35946002e-03,  7.52466982e-03,
         1.24153323e-02,  2.70469111e-02,  6.88684035e-02,
         9.21296239e-02,  1.04754526e-01,  9.74339502e-02,
         7.01687010e-02,  7.23436203e-02,  8.76604298e-02,
         6.58349083e-02,  5.64077232e-02,  3.95811215e-02,
         2.57592802e-02,  5.49040956e-03,  3.61233706e-03,
         4.05842065e-03,  2.16582172e-03,  2.03949791e-03,
         2.98901394e-03,  1.63122426e-02,  1.32911264e-01]])}[self.string]